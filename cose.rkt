#lang racket

(require
  (only-in file/sha1 hex-string->bytes)
  "dump.rkt"
  "cbor.rkt")

;;; CBOR Object Signing and Encryption (COSE)
;;; RFC8152
;;;
;;; COSE uses the following tags to identify the message type.
;;;
;;; 98 - cose-sign     COSE_Sign
;;; 18 - cose-sign1    COSE_Sign1
;;; 96 - cose-encrypt  COSE_Encrypt
;;; 16 - cose-encrypt0 COSE_Encrypt0
;;; 97 - cose-mac      COSE_Mac
;;; 17 - cose-mac0     COSE_Mac0

;;; First, let's support cose-sign and cose-sign1

;; Examples/rsa-pss-examples/rsa-pss-01.json
(define *sample1*
  (hex-string->bytes
      "D8628443A10300A054546869732069732074686520636F6E74656E742E818344\
A1013824A104581F6D65726961646F632E6272616E64796275636B407273612E\
6578616D706C65590100511AB7C07A4C9F1639FD955CDF17DB5FC9D7360E07E8\
DE8F835A6E443F56B816A842F5878707E9E4451F3EAEC39BBCB30C92EE07AC30\
F2C856A640D5BA5857F0A96135447F1A3FD207290AFC40A033FCACB6C031285E\
01FE4C9D4E528CA63C00C55109EA4F6E58232B5D9B7C5448CC4637C8EEAD7037\
CC71FDA4D1E83FB1FFA7294C744455785B9B9DBC7341826A6F90622533B9AA51\
998BEDBBD6D155869E189C4097B6E6EBBA2A5A6AA7E08AB8EDAB7021A567F36C\
715DE34CBF9048609503B7F70DA05EA6A6C7DF1301FB575ABE6F4DA8AAA93B5F\
A6267CA490F03BC90BB5705BB3398466C0AFE84AF91C0B752C6E1CAC149B07C2\
37988F47980F1301669C"))

;; For verification, the ToBeSigned of the above:
(define *to-be-signed-1*
  (hex-string->bytes
    "85695369676E617475726543A1030044A1013824405454686973206973207468\
6520636F6E74656E742E"))
